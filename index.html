<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>åœ°ç†ãŠåŠ©ã‘ãƒ„ãƒ¼ãƒ« Ultimate</title>
<style>
body{
  font-family:Arial;
  text-align:center;
  background:#111;
  color:white;
}
input,button{
  padding:10px;
  margin:5px;
  font-size:16px;
}
button{
  cursor:pointer;
}
#map{
  height:500px;
  margin-top:20px;
}
img{
  width:200px;
  margin-top:10px;
}
</style>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>

<body>

<h1>ğŸŒ åœ°ç†ãŠåŠ©ã‘ãƒ„ãƒ¼ãƒ« Ultimate</h1>

<input type="text" id="countryInput" placeholder="å›½åã‚’å…¥åŠ›ï¼ˆæ—¥æœ¬, USAãªã©ï¼‰">
<button onclick="searchCountry()">å›½æ¤œç´¢</button>
<button onclick="randomCountry()">ãƒ©ãƒ³ãƒ€ãƒ å›½</button>

<div id="result"></div>
<div id="map"></div>

<script>

let map = L.map('map').setView([20,0],2);
let marker = null;

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution:'Â© OpenStreetMap'
}).addTo(map);

async function searchCountry(){

    let name = document.getElementById("countryInput").value.trim();
    if(!name) return;

    try{
        let res = await fetch(`https://restcountries.com/v3.1/name/${name}`);
        if(!res.ok) throw new Error("å–å¾—å¤±æ•—");
        let data = await res.json();
        showCountry(data[0]);
    }catch(e){
        document.getElementById("result").innerHTML="âŒ å›½ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“";
    }
}

async function randomCountry(){
    try{
        let res = await fetch("https://restcountries.com/v3.1/all");
        let data = await res.json();
        let random = data[Math.floor(Math.random()*data.length)];
        showCountry(random);
    }catch(e){
        document.getElementById("result").innerHTML="âŒ ãƒ©ãƒ³ãƒ€ãƒ å–å¾—å¤±æ•—";
    }
}

function showCountry(country){

    let lat = country.latlng[0];
    let lng = country.latlng[1];

    map.setView([lat,lng],5);

    if(marker){
        map.removeLayer(marker);
    }

    marker = L.marker([lat,lng]).addTo(map);

    document.getElementById("result").innerHTML = `
        <h2>${country.name.common}</h2>
        <img src="${country.flags.png}">
        <p>é¦–éƒ½: ${country.capital ? country.capital[0] : "ãªã—"}</p>
        <p>äººå£: ${country.population.toLocaleString()}</p>
        <p>åœ°åŸŸ: ${country.region}</p>
    `;
}

</script>

</body>
</html>
